(()=>{"use strict";const t=document.querySelector(".create__button"),e=document.getElementById("create");async function o(t){try{const e=new Request(t,{method:"get"}),o=await fetch(e);return await o.json()}catch(t){console.log(t)}}function n(t){return Object.keys(t).map((e=>{const o=t[e];return o.id=e,o}))}async function s(t){await fetch(`https://project-68a00-default-rtdb.asia-southeast1.firebasedatabase.app/posts/${t}.json`,{method:"delete"})}t.addEventListener("click",(function(t){t.target.classList.add("hide"),e.classList.remove("hide")}));const a=document.querySelector(".content"),c=document.getElementById("show-posts");async function r(){const t=await o("https://project-68a00-default-rtdb.asia-southeast1.firebasedatabase.app/posts.json");a.innerHTML="",async function(){const t=n(await o("https://project-68a00-default-rtdb.asia-southeast1.firebasedatabase.app/posts.json"));let e=[];t.map((t=>{e.push(t.id)})),Array.from(document.querySelectorAll(".delete-post")).forEach((t=>{t.addEventListener("click",(async function(o){for(let o=0;o<e.length;o++)e[o]===t.id&&(t.parentElement.parentElement.remove(),await s(e[o]))}))}))}();const e=n(t).map((t=>function(t){const e=t.title,o=t.text;let n=document.createElement("div");a.prepend(n),n.className="post",n.innerHTML=`\n\t<div class="post-box">\n\t\t<h2 class="post-title">${e}</h2>\n\t\t<button class="button button-primary delete-post" id="${t.id}">Удалить</button>\n\t</div>\n\t<p class="post-text hide">${o}</p>\n `,Array.from(document.querySelectorAll(".post-title")).forEach((t=>{t.addEventListener("click",i),t.style.backgroundColor=`rgb(${d(0,255)}, ${d(0,255)}, ${d(0,255)})`}))}(t)));a.insertAdjacentHTML("beforebegin",e.join(" ")),l=!0,c.classList.add("hide-button"),localStorage.clear()}c.addEventListener("click",(function(){l||(r(),l=!0),!0===l&&(c.classList.add("hide-button"),l=!1)}));let l=!1;function i(){this.parentElement.nextElementSibling.classList.toggle("hide")}function d(t,e){return Math.floor(Math.random()*(e-t+1)+t)}const u=document.querySelector(".notification__button"),p=document.querySelector(".notification");u.addEventListener("click",(()=>{p.style.top="-150%"}));const h=document.querySelector(".error-title"),f=document.querySelector(".error-text");function m(t,e){e.style.border="1px solid rgb(133, 133, 133)",t.classList.add("hide")}function b(t,e,o){0==e.length&&(t.classList.remove("hide"),localStorage.clear(),o.style.border="1px solid red"),e.length>0&&(o.style.border="1px solid rgb(133, 133, 133)",t.classList.add("hide"))}const y=document.querySelector(".form__button"),g=document.getElementById("title"),E=document.getElementById("textarea");function L(){let t=!0;return localStorage.setItem(g.value,E.value),Object.keys(localStorage).forEach((e=>{const o=localStorage[e];let n=!0;n=localStorage[e].length&&n,n&&m(f,E),n&&m(h,g),t=t&&n,0!=e.length&&0!=o.length||(b(h,e,g),b(f,o,E),t=!1)})),t}y.addEventListener("click",(async function(o){o.preventDefault(),L(),L()&&(Object.keys(localStorage).forEach((t=>{L&&async function(t){try{const e=new Request("https://project-68a00-default-rtdb.asia-southeast1.firebasedatabase.app/posts.json",{method:"post",body:JSON.stringify(t)}),o=await fetch(e);await o.json()}catch(t){console.log(t)}}({title:t,text:localStorage[t]})})),g.value="",E.value="",p.style.top="40px",setTimeout((()=>{p.style.top="-150%"}),3e3),t.classList.remove("hide"),e.classList.add("hide"),setTimeout((()=>{r()}),300))})),g.addEventListener("input",(function(){g.style.border="1px solid rgb(141, 58, 189)"}))})();